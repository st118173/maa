!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","angular","./jquery.fileupload-image","./jquery.fileupload-audio","./jquery.fileupload-video","./jquery.fileupload-validate"],e):e()}(function(){"use strict";angular.module("blueimp.fileupload",[]).provider("fileUpload",function(){var e,t=function(e){var t=angular.element(this).fileupload("option","scope");t.$evalAsync(e)},n=function(e,t){var n=t.files,i=n[0];angular.forEach(n,function(e,n){e._index=n,e.$state=function(){return t.state()},e.$processing=function(){return t.processing()},e.$progress=function(){return t.progress()},e.$response=function(){return t.response()}}),i.$submit=function(){if(!i.error)return t.submit()},i.$cancel=function(){return t.abort()}};e=this.defaults={handleResponse:function(e,t){var n=t.result&&t.result.files;n?t.scope.replace(t.files,n):(t.errorThrown||"error"===t.textStatus)&&(t.files[0].error=t.errorThrown||t.textStatus)},add:function(e,t){if(e.isDefaultPrevented())return!1;var i=t.scope,r=[];angular.forEach(t.files,function(e){r.push(e)}),i.$parent.$applyAsync(function(){n(i,t);var e=i.option("prependFiles")?"unshift":"push";Array.prototype[e].apply(i.queue,t.files)}),t.process(function(){return i.process(t)}).always(function(){i.$parent.$applyAsync(function(){n(i,t),i.replace(r,t.files)})}).then(function(){(i.option("autoUpload")||t.autoUpload)&&t.autoUpload!==!1&&t.submit()})},done:function(e,t){if(e.isDefaultPrevented())return!1;var n=this;t.scope.$apply(function(){t.handleResponse.call(n,e,t)})},fail:function(e,t){if(e.isDefaultPrevented())return!1;var n=this,i=t.scope;return"abort"===t.errorThrown?void i.clear(t.files):void i.$apply(function(){t.handleResponse.call(n,e,t)})},stop:t,processstart:t,processstop:t,getNumberOfFiles:function(){var e=this.scope;return e.queue.length-e.processing()},dataType:"json",autoUpload:!1},this.$get=[function(){return{defaults:e}}]}).provider("formatFileSizeFilter",function(){var e={units:[{size:1e9,suffix:" GB"},{size:1e6,suffix:" MB"},{size:1e3,suffix:" KB"}]};this.defaults=e,this.$get=function(){return function(t){if(!angular.isNumber(t))return"";for(var n,i,r=!0,o=0;r;){if(r=e.units[o],n=r.prefix||"",i=r.suffix||"",o===e.units.length-1||t>=r.size)return n+(t/r.size).toFixed(2)+i;o+=1}}}}).controller("FileUploadController",["$scope","$element","$attrs","$window","fileUpload",function(e,t,n,i,r){var o={progress:function(){return t.fileupload("progress")},active:function(){return t.fileupload("active")},option:function(e,n){return 1===arguments.length?t.fileupload("option",e):void t.fileupload("option",e,n)},add:function(e){return t.fileupload("add",e)},send:function(e){return t.fileupload("send",e)},process:function(e){return t.fileupload("process",e)},processing:function(e){return t.fileupload("processing",e)}};e.disabled=!i.jQuery.support.fileInput,e.queue=e.queue||[],e.clear=function(e){var t=this.queue,n=t.length,i=e,r=1;for(angular.isArray(e)&&(i=e[0],r=e.length);n;)if(n-=1,t[n]===i)return t.splice(n,r)},e.replace=function(e,t){var n,i,r=this.queue,o=e[0];for(n=0;n<r.length;n+=1)if(r[n]===o){for(i=0;i<t.length;i+=1)r[n+i]=t[i];return}},e.applyOnQueue=function(e){var t,n,i=this.queue.slice(0);for(t=0;t<i.length;t+=1)n=i[t],n[e]&&n[e]()},e.submit=function(){this.applyOnQueue("$submit")},e.cancel=function(){this.applyOnQueue("$cancel")},angular.extend(e,o),t.fileupload(angular.extend({scope:e},r.defaults)).on("fileuploadadd",function(t,n){n.scope=e}).on("fileuploadfail",function(e,t){if("abort"!==t.errorThrown&&t.dataType&&t.dataType.indexOf("json")===t.dataType.length-4)try{t.result=angular.fromJson(t.jqXHR.responseText)}catch(e){}}).on(["fileuploadadd","fileuploadsubmit","fileuploadsend","fileuploaddone","fileuploadfail","fileuploadalways","fileuploadprogress","fileuploadprogressall","fileuploadstart","fileuploadstop","fileuploadchange","fileuploadpaste","fileuploaddrop","fileuploaddragover","fileuploadchunksend","fileuploadchunkdone","fileuploadchunkfail","fileuploadchunkalways","fileuploadprocessstart","fileuploadprocess","fileuploadprocessdone","fileuploadprocessfail","fileuploadprocessalways","fileuploadprocessstop"].join(" "),function(t,n){e.$parent.$applyAsync(function(){e.$emit(t.type,n).defaultPrevented&&t.preventDefault()})}).on("remove",function(){var t;for(t in o)o.hasOwnProperty(t)&&delete e[t]}),e.$watch(n.fileUpload,function(e){e&&t.fileupload("option",e)})}]).controller("FileUploadProgressController",["$scope","$attrs","$parse",function(e,t,n){var i=n(t.fileUploadProgress),r=function(){var t=i(e);t&&t.total&&(e.num=Math.floor(t.loaded/t.total*100))};r(),e.$watch(t.fileUploadProgress+".loaded",function(e,t){e!==t&&r()})}]).controller("FileUploadPreviewController",["$scope","$element","$attrs",function(e,t,n){e.$watch(n.fileUploadPreview+".preview",function(e){t.empty(),e&&t.append(e)})}]).directive("fileUpload",function(){return{controller:"FileUploadController",scope:!0}}).directive("fileUploadProgress",function(){return{controller:"FileUploadProgressController",scope:!0}}).directive("fileUploadPreview",function(){return{controller:"FileUploadPreviewController"}}).directive("download",function(){return function(e,t){t.on("dragstart",function(e){try{e.originalEvent.dataTransfer.setData("DownloadURL",["application/octet-stream",t.prop("download"),t.prop("href")].join(":"))}catch(e){}})}})});