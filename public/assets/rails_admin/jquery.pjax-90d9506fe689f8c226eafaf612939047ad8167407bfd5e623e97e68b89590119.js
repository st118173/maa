!function(e){function t(t,n,r){var o=this;return this.on("click.pjax",t,function(t){var s=e.extend({},p(n,r));s.container||(s.container=e(this).attr("data-pjax")||o),i(t,s)})}function i(t,i,n){n=p(i,n);var o=t.currentTarget;if("A"!==o.tagName.toUpperCase())throw"$.fn.pjax or $.pjax.click requires an anchor element";if(!(t.which>1||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey||location.protocol!==o.protocol||location.host!==o.host||o.hash&&o.href.replace(o.hash,"")===location.href.replace(location.hash,"")||o.href===location.href+"#")){var s={url:o.href,container:e(o).attr("data-pjax"),target:o,fragment:null};r(e.extend({},s,n)),t.preventDefault()}}function n(t,i,n){n=p(i,n);var o=t.currentTarget;if("FORM"!==o.tagName.toUpperCase())throw"$.pjax.submit requires a form element";var s={type:o.method,url:o.action,data:e(o).serializeArray(),container:e(o).attr("data-pjax"),target:o,fragment:null};r(e.extend({},s,n)),t.preventDefault()}function r(t){function i(t,i){var r=e.Event(t,{relatedTarget:n});return a.trigger(r,i),!r.isDefaultPrevented()}t=e.extend(!0,{},e.ajaxSettings,r.defaults,t),e.isFunction(t.url)&&(t.url=t.url());var n=t.target,o=c(t.url).hash,a=t.context=h(t.container);t.data||(t.data={}),t.data._pjax=a.selector;var l;t.beforeSend=function(e,n){"GET"!==n.type&&(n.timeout=0),e.setRequestHeader("X-PJAX","true"),e.setRequestHeader("X-PJAX-Container",a.selector);return!!i("pjax:beforeSend",[e,n])&&(n.timeout>0&&(l=setTimeout(function(){i("pjax:timeout",[e,t])&&e.abort("timeout")},n.timeout),n.timeout=0),void(t.requestUrl=c(n.url).href))},t.complete=function(e,n){l&&clearTimeout(l),i("pjax:complete",[e,n,t]),i("pjax:end",[e,t])},t.error=function(e,n,r){var o=m("",e,t),a=i("pjax:error",[e,n,r,t]);"GET"==t.type&&"abort"!==n&&a&&s(o.url)},t.success=function(n,l,d){var p=m(n,d,t);if(!p.contents)return void s(p.url);if(r.state={id:t.id||u(),url:p.url,title:p.title,container:a.selector,fragment:t.fragment,timeout:t.timeout},(t.push||t.replace)&&window.history.replaceState(r.state,p.title,p.url),p.title&&(document.title=p.title),a.html(p.contents),"number"==typeof t.scrollTo&&e(window).scrollTop(t.scrollTo),(t.replace||t.push)&&window._gaq&&_gaq.push(["_trackPageview"]),""!==o){var h=c(p.url);h.hash=o,r.state.url=h.href,window.history.replaceState(r.state,p.title,h.href);var f=e(h.hash);f.length&&e(window).scrollTop(f.offset().top)}i("pjax:success",[n,l,d,t])},r.state||(r.state={id:u(),url:window.location.href,title:document.title,container:a.selector,fragment:t.fragment,timeout:t.timeout},window.history.replaceState(r.state,document.title));var p=r.xhr;p&&p.readyState<4&&(p.onreadystatechange=e.noop,p.abort()),r.options=t;var p=r.xhr=e.ajax(t);return p.readyState>0&&(t.push&&!t.replace&&(g(r.state.id,a.clone().contents()),window.history.pushState(null,"",d(t.requestUrl))),i("pjax:start",[p,t]),i("pjax:send",[p,t])),r.xhr}function o(t,i){var n={url:window.location.href,push:!1,replace:!0,scrollTo:!1};return r(e.extend(n,p(t,i)))}function s(e){window.history.replaceState(null,"","#"),window.location.replace(e)}function a(t){var i=t.state;if(i&&i.container){var n=e(i.container);if(n.length){var o=_[i.id];if(!r.state)return void(r.state=i);var a=r.state.id<i.id?"forward":"back";v(a,r.state.id,n.clone().contents());var l=e.Event("pjax:popstate",{state:i,direction:a});n.trigger(l);var u={id:i.id,url:i.url,container:n,push:!1,fragment:i.fragment,timeout:i.timeout,scrollTo:!1};o?(n.trigger("pjax:start",[null,u]),i.title&&(document.title=i.title),n.html(o),r.state=i,n.trigger("pjax:end",[null,u])):r(u),n[0].offsetHeight}else s(location.href)}}function l(t){var i=e.isFunction(t.url)?t.url():t.url,n=t.type?t.type.toUpperCase():"GET",r=e("<form>",{method:"GET"===n?"GET":"POST",action:i,style:"display:none"});"GET"!==n&&"POST"!==n&&r.append(e("<input>",{type:"hidden",name:"_method",value:n.toLowerCase()}));var o=t.data;if("string"==typeof o)e.each(o.split("&"),function(t,i){var n=i.split("=");r.append(e("<input>",{type:"hidden",name:n[0],value:n[1]}))});else if("object"==typeof o)for(key in o)r.append(e("<input>",{type:"hidden",name:key,value:o[key]}));e(document.body).append(r),r.submit()}function u(){return(new Date).getTime()}function d(e){return e.replace(/\?_pjax=[^&]+&?/,"?").replace(/_pjax=[^&]+&?/,"").replace(/[\?&]$/,"")}function c(e){var t=document.createElement("a");return t.href=e,t}function p(t,i){return t&&i?i.container=t:i=e.isPlainObject(t)?t:{container:t},i.container&&(i.container=h(i.container)),i}function h(t){if(t=e(t),t.length){if(""!==t.selector&&t.context===document)return t;if(t.attr("id"))return e("#"+t.attr("id"));throw"cant get selector for pjax container!"}throw"no pjax container for "+t.selector}function f(e,t){return e.filter(t).add(e.find(t))}function m(t,i,n){var r={};if(r.url=d(i.getResponseHeader("X-PJAX-URL")||n.requestUrl),/<html/i.test(t))var o=e(t.match(/<head[^>]*>([\s\S.]*)<\/head>/i)[0]),s=e(t.match(/<body[^>]*>([\s\S.]*)<\/body>/i)[0]);else var o=s=e(t);if(0===s.length)return r;if(r.title=f(o,"title").last().text(),n.fragment){if("body"===n.fragment)var a=s;else var a=f(s,n.fragment).first();a.length&&(r.contents=a.contents(),r.title||(r.title=a.attr("title")||a.data("title")))}else/<html/i.test(t)||(r.contents=s);return r.contents&&(r.contents=r.contents.not("title"),r.contents.find("title").remove()),r.title&&(r.title=e.trim(r.title)),r}function g(e,t){for(_[e]=t,x.push(e);w.length;)delete _[w.shift()];for(;x.length>r.defaults.maxCacheLength;)delete _[x.shift()]}function v(e,t,i){var n,r;_[t]=i,"forward"===e?(n=x,r=w):(n=w,r=x),n.push(t),(t=r.pop())&&delete _[t]}function y(){e.fn.pjax=t,e.pjax=r,e.pjax.enable=e.noop,e.pjax.disable=b,e.pjax.click=i,e.pjax.submit=n,e.pjax.reload=o,e.pjax.defaults={timeout:650,push:!0,replace:!1,type:"GET",dataType:"html",scrollTo:0,maxCacheLength:20},e(window).bind("popstate.pjax",a)}function b(){e.fn.pjax=function(){return this},e.pjax=l,e.pjax.enable=y,e.pjax.disable=e.noop,e.pjax.click=e.noop,e.pjax.submit=e.noop,e.pjax.reload=function(){window.location.reload()},e(window).unbind("popstate.pjax",a)}var _={},w=[],x=[];e.inArray("state",e.event.props)<0&&e.event.props.push("state"),e.support.pjax=window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]|WebApps\/.+CFNetwork)/),e.support.pjax?y():b()}(jQuery);